# 2024_KAMP_AI_Manufacturing_Data_Analysis
2024 제 4회 k-인공지능 제조데이터 분석 경진대회 / 우수상

## 📌 문제 정의
- 불량을 양품으로 잘못 판단(False Negative)하는 오류 발생  
- 센서는 공정 데이터만 기록하고, 품질은 사후에만 확인 가능 → **예측 시차 문제 존재**  
- 재료 특성 정보가 누락되어 실제 결과와 예측 결과 간 불일치 발생  

## 🎯 분석 목표
- False Negative 최소화  
- 불량을 양품으로 오판하는 원인 변수 탐색  
- 공정 데이터를 기반으로 한 **불량 예측 모델 구축**

## 🔧 제조데이터 정의 및 처리
- 기간: 2019-01-02 16:45 ~ 2019-03-31 23:59  
- 데이터 규모: **92,106 Rows × 31 Columns**  
- 종속변수: `passorfail`  
- 처리 과정: 데이터 전처리 및 품질 지수 평가 (완전성, 유효성, 일관성, 정확성, 무결성)  
- 새로운 Feature 발굴 및 데이터 불균형 문제 해결 시도


## 📊 데이터 분석
### 1. **변수 분석**
   - `사탕신호`: 결측치(NaN)가 매우 많음  
   - `가열로`: 값이 A, B, NaN으로 이루어져있으나, 이 값들이 각각 어떤 의미인지 설명 부족  
   - 대회 가이드북에서는 결측치는 모두 제거 후 사용하도록 제시했으나,  
     ➡️ 우리는 **결측치를 단순 제거하지 않고 모델에 반영하면 성능 향상이 가능하다**고 판단  
   - 따라서 “NaN 값은 무엇을 의미하는가?”, “가열로의 A/B/NaN 값은 실제 공정에서 어떤 차이를 반영하는가?” 라는 질문에서 분석을 시작함
  
### 2. **가설 검정**
- **가설 1**: 사탕신호 NaN 여부가 모델 성능에 영향을 준다 → **채택 (O)**
    - 사탕신호는 공정 시작 전 **테스트(try-shot)를 알리는 신호**임을 확인  
    - 값이 존재 → 시험 데이터 (실제 품질 반영 X, 오히려 노이즈)  
    - 값이 NaN → 실제 정상 공정 데이터
    - 사탕신호가 NaN일 때만 사용하면 **성능 7% 향상**
    - 따라서 **사탕신호가 NaN인 경우만 사용하는 것이 올바른 분석**  

- **가설 2**: 가열로 값(A/B/NaN)에 따라 품질에 차이가 존재한다 → 일부 구간에서 성능 차이가 있었으나, 뚜렷한 영향은 확인되지 않음 → **부분 채택 (Δ)**  

- **가설 3**: 사탕신호와 가열로의 조합이 품질에 영향을 준다 → 사탕신호는 유효, 가열로는 영향 불확실 → **부분 채택 (Δ)**  

➡️ **결론**: 주어진 데이터에서는 `사탕신호가 NaN인 경우` 가 오히려 정상 데이터이며, 이를 사용해야 올바른 분석 가능

### 3. 모델링

- **Decision Tree (DT)**  
  - 규칙 기반 모델로, 공정 변수들의 조건을 분할해 불량 여부를 예측  
  - 장점: 결과가 트리 구조로 표현되므로 해석 용이 → 작업자가 직접 공정 규칙을 이해하고 활용 가능  
  - 활용: 불량 발생 규칙을 명확히 정의하여 **공정 규칙 자동화**에 기여  

- **Random Forest**  
  - 여러 개의 Decision Tree를 앙상블해 과적합을 방지하고 예측 성능을 향상  
  - 다수결/평균 방식을 통해 안정적인 결과 제공  

- **LSTM + Transformer**  
  - **LSTM**: 시계열 데이터의 장기 의존성(Long-term dependency) 학습에 강점  
  - **Transformer**: Attention 메커니즘을 활용해 시계열 내 중요한 구간에 가중치를 부여, 학습 효율 개선  
  - 두 모델을 결합해 **복잡한 공정 시계열 데이터에서 패턴을 포착**하고 정밀한 불량 예측 수행  

### 4. 데이터 기반 공정 해석
- 데이터를 정제 후 통계량을 분석한 결과, 해당 데이터가 **알루미늄 합금 기반 다이캐스팅 공정**임을 추정  
- 알루미늄 합금은 열전도율, 내식성, 용융 특성 등으로 인해 공정 품질에 큰 영향을 줌  
- 즉, 단순히 주어진 정답 레이블만 신뢰하기보다는, **도메인 특성을 반영한 Feature 설계가 필수적**임  
- 알루미늄의 물리적 특성을 함께 고려해야 실제 공정 현장에서 더 신뢰할 수 있는 예측 모델을 만들 수 있음


### 5. 분석 기법
1. **원본 데이터 학습**  
   - 전처리 없이 원본 데이터 그대로 학습  
   - 불균형 데이터 (정상 약 89,000건 / 불량 약 2,000건)  

2. **Min-Max 스케일링**  
   - 값의 스케일 차이를 해소하기 위해 정규화  
   - 모델 수렴 성능 개선 목적  

3. **가중치 조정 학습**  
   - 불량 데이터(Label=1)에 3:1 비율 가중치 부여  
   - 소수 클래스 학습 성능 개선  

4. **SMOTE 데이터 증강**  
   - 불량 데이터 샘플을 40,000개로 증강  
   - 정상 데이터는 무작위로 40,000개 추출 → 총 80,000개 데이터셋 구성  
   - 데이터 불균형 해소 후 학습 진행 


## 📈 결과
1. 모든 변수 포함
   
| Metric    | DecisionTree | DecisionTree (max_depth=4) | RandomForest |
|:---------:|:------------:|:--------------------------:|:------------:|
| Accuracy  | 0.9879       | 0.9876                     | 0.9927       |
| F1-score  | 0.8618       | 0.8406                     | 0.9130       |

2. Tryshot_signal(Nan,D) & heating_furnace(Nan,A,B)
   
|                  | heating_furnace (A) | heating_furnace (B) | heating_furnace (NaN) |
|:----------------:|:-------------------:|:-------------------:|:---------------------:|
| Tryshot_signal (NaN) | 0.9633              | 0.9406              | 0.8853                |
| Tryshot_signal (D)   | .                   | .                   | .                     |


## 🚀 기대효과
### 1. 공정 규칙 자동화 및 품질 안정화
- Decision Tree 기반 규칙 자동화로 불량 원인을 명확히 규명  
- 작업자 경험과 무관하게 **일관된 품질 유지** 가능  
- False Positive 문제 해결 및 품질 신뢰성 확보  

### 2. 데이터 기반 의사결정
- AI 기반 데이터 분석 도입 → **데이터 기반 의사결정 문화 정착**  
- 해석 가능한 모델(Decision Tree) 제공 → 비전문가도 공정 규칙 이해 가능  
- 품질 요인을 명확히 파악하고 타 공정 및 다른 제조 분야에도 확장 가능  
- 중소기업의 AI 활용 신뢰도 제고 및 제조 혁신 촉진
